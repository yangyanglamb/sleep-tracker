# 时间格式更新说明

## 更新内容

已成功更新时间显示格式，现在使用更人性化的中文时间表示。

## 新的时间格式

### 睡眠记录格式
```
xx月xx日xx时-xx月xx日xx时 共睡了xxx
```

**示例：**
- `10月28日08时-10月28日09时 共睡了30分钟`
- `10月28日08时-10月28日16时 共睡了8小时`
- `10月28日08时-10月28日16时 共睡了8小时30分钟`
- `10月28日01时-10月29日01时 共睡了24小时`

### 饮食记录格式
```
xx月xx日xx时 (饮食类型)
```

**示例：**
- `10月28日08时 (早餐)`
- `10月28日12时 (午餐)`
- `10月28日18时 (晚餐)`

## 时长显示规则

| 睡眠时长 | 显示格式 | 示例 |
|---------|--------|------|
| 不足1分钟 | 共睡了0分钟 | 共睡了0分钟 |
| 1-59分钟 | 共睡了XX分钟 | 共睡了45分钟 |
| 1小时整 | 共睡了1小时 | 共睡了1小时 |
| 1小时以上 | 共睡了XX小时YY分钟 | 共睡了8小时30分钟 |

## 数据库说明

### 数据存储
- 时间数据在数据库中仍以 ISO 8601 格式存储（精确到秒）
- 只有显示格式改变，不影响数据准确性
- 所有历史数据仍完整保留

### 表结构
保持不变，无需迁移：
```sql
sleep_records: id, sleep_start, sleep_end, created_at, updated_at
meal_records: id, meal_time, meal_type, created_at
```

## API 响应示例

### 睡眠记录 API
```json
{
  "message": "睡眠记录完成",
  "display": "10月28日08时-10月28日09时 共睡了30分钟",
  "id": 1
}
```

### 获取睡眠记录
```json
[
  {
    "id": 1,
    "display": "10月28日08时-10月28日09时 共睡了30分钟"
  },
  {
    "id": 2,
    "display": "10月28日22时-10月29日07时 共睡了9小时"
  }
]
```

### 饮食记录 API
```json
[
  {
    "id": 1,
    "display": "10月28日08时 (早餐)"
  },
  {
    "id": 2,
    "display": "10月28日12时 (午餐)"
  }
]
```

## 修改的代码位置

### server.js 中的修改

1. **formatDateTime 函数** (第 66-74 行)
   - 从 `YYYYMMDDHHYYMM` 格式改为 `xx月xx日xx时`

2. **formatSleepDisplay 函数** (第 76-94 行)
   - 更新睡眠时长文本
   - 从 `时/分` 改为 `小时/分钟`

3. **meal_records API** (第 219-228 行)
   - 饮食记录显示格式更新
   - 从 `YYYYMMDD HH:MM` 改为 `xx月xx日xx时`

## 向后兼容性

- ✅ 前端网页自动显示新格式
- ✅ API 自动返回新格式
- ✅ 数据库无需迁移
- ✅ 历史数据保持不变
- ✅ 所有功能完全兼容

## 测试验证

已验证以下场景：
- ✓ 分钟级睡眠时长显示
- ✓ 小时级睡眠时长显示
- ✓ 小时 + 分钟混合显示
- ✓ 饮食记录时间格式
- ✓ 所有饮食类型显示
- ✓ API 接口响应格式
- ✓ 网页前端显示

## 更新后的体验

### 之前
```
2025102808:39-2025102809:39 共睡了1时
20251028 08:39 (早餐)
```

### 之后
```
10月28日08时-10月28日09时 共睡了1小时
10月28日08时 (早餐)
```

更清晰、更易读的中文格式！
